(function(e){function t(t){for(var n,s,r=t[0],c=t[1],l=t[2],d=0,f=[];d<r.length;d++)s=r[d],Object.prototype.hasOwnProperty.call(a,s)&&a[s]&&f.push(a[s][0]),a[s]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);u&&u(t);while(f.length)f.shift()();return o.push.apply(o,l||[]),i()}function i(){for(var e,t=0;t<o.length;t++){for(var i=o[t],n=!0,r=1;r<i.length;r++){var c=i[r];0!==a[c]&&(n=!1)}n&&(o.splice(t--,1),e=s(s.s=i[0]))}return e}var n={},a={app:0},o=[];function s(t){if(n[t])return n[t].exports;var i=n[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=e,s.c=n,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(i,n,function(t){return e[t]}.bind(null,n));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=t,r=r.slice();for(var l=0;l<r.length;l++)t(r[l]);var u=c;o.push([0,"chunk-vendors"]),i()})({0:function(e,t,i){e.exports=i("56d7")},"034f":function(e,t,i){"use strict";i("85ec")},1:function(e,t){},2:function(e,t){},3:function(e,t){},4:function(e,t){},5:function(e,t){},5250:function(e,t,i){},5383:function(e,t,i){"use strict";i("5ca7")},"56d7":function(e,t,i){"use strict";i.r(t);i("e260"),i("e6cf"),i("cca6"),i("a79d");var n=i("2b0e"),a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"app"}},[i("router-view")],1)},o=[],s={name:"App",components:{}},r=s,c=(i("034f"),i("2877")),l=Object(c["a"])(r,a,o,!1,null,null,null),u=l.exports,d=i("8c4f"),f=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"container"}},[i("ConfirmationModal"),i("MapSidebar",{ref:"MapSidebar"}),i("Map"),i("UnsuccessfulBookingModal")],1)},p=[],b=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("MapAvailabilityPicker"),i("div",{attrs:{id:"mapContainer"}})],1)},v=[],m=(i("4ec9"),i("d3b7"),i("3ca3"),i("ddb0"),i("d81d"),i("b0c0"),i("ac1f"),i("1276"),i("7db0"),i("6cc5"),i("e11e")),h=i.n(m),g=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("b-datepicker",{staticClass:"datepicker",attrs:{placeholder:"Select date to see available dentists for the day","start-weekday":e.startDay,locale:"en-us",min:e.minDate,max:e.maxDate},on:{input:function(t){return e.getDateAvailability(e.date)}},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}})],1)},y=[],k=(i("07ac"),{name:"MapAvailabilityPicker",data:function(){var e=new Date;e.setFullYear(e.getFullYear()+1);var t=new Date;return t.setDate(t.getDate()+1),{date:"",minDate:t,maxDate:e,startDay:1}},watch:{dateAvailability:{handler:function(){this.checkTimeslotResponse()},deep:!0,immediate:!0}},computed:{dateAvailability:function(){return this.$store.getters["availability/getAvailability"]}},methods:{getDateAvailability:function(e){this.$store.dispatch("availability/removeAvailability",this.$store.state.availability.availabilityDate),this.$store.dispatch("availability/selectDate",e)},checkTimeslotResponse:function(){if(0!==Object.values(this.$store.state.availability.availability).length&&this.date)for(var e in this.$store.state.availability.availability){var t=e,i=this.$store.state.availability.availability[e];this.$parent.markAvailability(t,i)}else this.$parent.loaded&&this.$parent.setDentistMarkers()}}}),C=k,_=Object(c["a"])(C,g,y,!1,null,"51b8d7ce",null),w=_.exports,S={name:"Map",components:{MapAvailabilityPicker:w},data:function(){return{myMap:Map,markerGroup:{},loaded:!1}},computed:{clinics:function(){return this.$store.state.dentist}},watch:{clinics:{deep:!0,handler:function(){this.setDentistMarkers()}}},mounted:function(){this.initiateMap(),delete m["Icon"].Default.prototype._getIconUrl,m["Icon"].Default.mergeOptions({iconRetinaUrl:i("584d"),iconUrl:i("6397"),shadowUrl:i("e2b9")}),this.loaded=!0},methods:{initiateMap:function(){this.myMap=h.a.map("mapContainer").setView([57.7089,11.9746],12),h.a.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,accessToken:"pk.eyJ1IjoiZWVtaWxndXNlIiwiYSI6ImNraG44czlpazBkZGUyc2wxYXRmdDNzd3IifQ.X7rb29PK55Oi8EZ8XQ6jtw"}).addTo(this.myMap),this.markerGroup=h.a.layerGroup().addTo(this.myMap)},setDentistMarkers:function(){var e=this,t=this.clinics.dentists;this.markerGroup.clearLayers();for(var i=function(i){var n=t[i].coordinate.longitude,a=t[i].coordinate.latitude,o=h.a.marker([a,n],{id:t[i].id}).addTo(e.markerGroup).on("click",(function(n){console.log(n.latlng),e.$parent.initSidebar(),void 0!==e.$store.state.selectedClinic.clinic.id&&e.$store.dispatch("selectedClinic/removeClinic",e.$store.state.selectedClinic.clinic.id),e.$store.dispatch("selectedClinic/selectClinic",t[i])}));o.bindPopup(t[i].name),o.on("mouseover",(function(){o.openPopup()}))},n=0;n<t.length;n++)i(n)},markAvailability:function(e,t){var i=parseInt(e.split("id")[1]),n=new h.a.Icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-green.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),a=new h.a.Icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-red.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]});this.markerGroup.getLayers().find((function(e){e.options.id===i&&(t?e.setIcon(n).update():e.setIcon(a).update())}))}}},O=S,A=(i("9e74"),Object(c["a"])(O,b,v,!1,null,"4db1490c",null)),T=A.exports,M=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("BookingModal",{ref:"BookingModal"}),i("b-sidebar",{attrs:{id:"sidebar-variant",width:"40%","bg-variant":"light","text-variant":"dark",shadow:""},model:{value:e.sidebarCheck,callback:function(t){e.sidebarCheck=t},expression:"sidebarCheck"}},[i("b-container",{staticClass:"container-fluid"},[i("h2",[e._v(e._s(e.selectedClinic.name))]),i("b-row",[i("div",{staticClass:"col-5",attrs:{id:"clinicInfo"}},[i("ClinicInformation",{attrs:{"clinic-information":e.selectedClinic}})],1),i("div",{staticClass:"col-5",attrs:{id:"clinicSchedule"}},[i("OpeningHours",{attrs:{"opening-hours":e.openingHours}})],1)]),i("b-calendar",{attrs:{min:e.minDate,"start-weekday":e.startDay,max:e.maxDate,locale:"en-us"},on:{selected:function(t){return e.displayTimeSlots()}},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}}),e.timeSlots?i("div",{staticClass:"container",attrs:{id:"timeContainer"}},e._l(e.timeSlots,(function(t,n){return i("b-button",{key:n,staticClass:"timeButton",attrs:{disabled:e.checkIfAvailable(t)},on:{click:function(i){return e.openModal(e.date,t.time)}}},[e._v(e._s(t.time))])})),1):e._e()],1)],1)],1)},I=[],D=(i("c740"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("b-modal",{attrs:{id:"modal-1",size:"lg",title:"Confirm Booking","hide-footer":""},model:{value:e.showModal,callback:function(t){e.showModal=t},expression:"showModal"}},[i("div",{staticClass:"container"},[i("p",[e._v(e._s(e.selectedClinic.name))]),i("p",[e._v(e._s(e.selectedClinic.address))]),i("p",[e._v(e._s(e.date))]),i("p",[e._v(e._s(e.time))])]),i("ValidationObserver",{scopedSlots:e._u([{key:"default",fn:function(t){var n=t.invalid;return[i("form",{staticClass:"form-styling",on:{submit:function(t){return t.preventDefault(),e.onConfirm.apply(null,arguments)}}},[i("ValidationProvider",{attrs:{name:"name",rules:"required|alpha_spaces"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.errors;return[i("div",{staticClass:"form-group"},[i("label",{attrs:{for:"name"}},[e._v("Name")]),i("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"name"}],staticClass:"form-control",attrs:{name:"name",id:"name",type:"text"},domProps:{value:e.name},on:{input:function(t){t.target.composing||(e.name=t.target.value)}}}),n[0]?i("div",{staticClass:"alert-danger"},[e._v(e._s(n[0]))]):e._e()])]}}],null,!0)}),i("ValidationProvider",{attrs:{name:"email",rules:"required|email"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.errors;return[i("div",{staticClass:"form-group"},[i("label",{attrs:{for:"email"}},[e._v("Email")]),i("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],staticClass:"form-control",attrs:{name:"email",id:"email",type:"email"},domProps:{value:e.email},on:{input:function(t){t.target.composing||(e.email=t.target.value)}}}),n[0]?i("div",{staticClass:"alert-danger"},[e._v(e._s(n[0]))]):e._e()])]}}],null,!0)}),i("ValidationProvider",{attrs:{name:"phone",rules:"required|numeric"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.errors;return[i("div",{staticClass:"form-group"},[i("label",{attrs:{for:"phone"}},[e._v("Phone")]),i("input",{directives:[{name:"model",rawName:"v-model",value:e.phone,expression:"phone"}],staticClass:"form-control",attrs:{name:"phone",id:"phone",type:"text"},domProps:{value:e.phone},on:{input:function(t){t.target.composing||(e.phone=t.target.value)}}}),n[0]?i("div",{staticClass:"alert-danger"},[e._v(" "+e._s(n[0]))]):e._e()])]}}],null,!0)}),i("div",{staticClass:"footer"},[i("b-button",{staticClass:"button-styling",attrs:{variant:"secondary",type:"reset"},on:{click:function(t){return e.hide()}}},[e._v("Cancel")]),i("b-button",{staticClass:"button-styling",attrs:{variant:"info",type:"submit",disabled:n}},[e._v("Confirm")])],1)],1)]}}])})],1)],1)}),j=[],x={name:"BookingModal",data:function(){return{showModal:!1,name:"",email:"",phone:"",date:"",time:""}},computed:{selectedClinic:function(){return this.$store.state.selectedClinic.clinic}},methods:{show:function(e,t){this.showModal=!0,this.date=e,this.time=t},hide:function(){this.showModal=!1},onConfirm:function(){var e=this.selectedClinic,t=this.date,i=this.time,n={};n.email=this.email,n.name=this.name,n.phone=this.phone,this.$store.dispatch("booking/createBookingRequest",{clinic:e,requestDate:t,requestTime:i,user:n}),this.hide()}}},R=x,B=Object(c["a"])(R,D,j,!1,null,"4db05e73",null),P=B.exports,$=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("p",{attrs:{id:"hoursMonday"}},[e._v("Monday: "+e._s(this.openingHours.monday||"Closed"))]),i("p",{attrs:{id:"hoursTuesday"}},[e._v("Tuesday: "+e._s(this.openingHours.tuesday||"Closed"))]),i("p",{attrs:{id:"hoursWednesday"}},[e._v("Wednesday: "+e._s(this.openingHours.wednesday||"Closed"))]),i("p",{attrs:{id:"hoursThursday"}},[e._v("Thursday: "+e._s(this.openingHours.thursday||"Closed"))]),i("p",{attrs:{id:"hoursFriday"}},[e._v("Friday: "+e._s(this.openingHours.friday||"Closed"))]),i("p",{attrs:{id:"hoursSaturday"}},[e._v("Saturday: "+e._s(this.openingHours.saturday||"Closed"))]),i("p",{attrs:{id:"hoursSunday"}},[e._v("Sunday: "+e._s(this.openingHours.sunday||"Closed"))])])},E=[],q={name:"OpeningHours",props:["openingHours"],data:function(){return{}}},U=q,N=Object(c["a"])(U,$,E,!1,null,"48f411f2",null),H=N.exports,L=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("p",[e._v("Owner: "+e._s(e.clinicInformation.owner))]),i("p",[e._v("Address: "+e._s(e.clinicInformation.address))]),i("p",[e._v("City: "+e._s(e.clinicInformation.city))])])},Y=[],G={name:"ClinicInformation",props:["clinicInformation"]},V=G,z=Object(c["a"])(V,L,Y,!1,null,"02d7e74f",null),Q=z.exports,F={name:"MapSidebar",components:{ClinicInformation:Q,OpeningHours:H,BookingModal:P},data:function(){var e=new Date;e.setFullYear(e.getFullYear()+1);var t=new Date;return t.setDate(t.getDate()+1),{date:"",minDate:t,maxDate:e,startDay:1,sidebarCheck:!1,timeSlots:[],bookingCheck:!1}},watch:{clinicAvailability:{handler:function(){this.displayTimeSlots()},deep:!0,immediate:!0}},computed:{selectedClinic:function(){return this.$store.state.selectedClinic.clinic},clinicAvailability:function(){return this.$store.getters["selectedClinic/getAvailability"]},openingHours:function(){return this.selectedClinic.openinghours?this.$store.state.selectedClinic.clinic.openinghours:"Not Available"}},methods:{displayTimeSlots:function(){var e=this;if(this.$store.state.selectedClinic.clinic.availability&&this.date){var t=this.$store.state.selectedClinic.clinic.availability.findIndex((function(t){return t.date===e.date}));this.$store.state.selectedClinic.clinic.availability[t]?this.timeSlots=this.$store.state.selectedClinic.clinic.availability[t].timeslots:this.timeSlots=[]}},openModal:function(e,t){this.$refs.BookingModal.show(e,t)},showSidebar:function(){this.sidebarCheck=!0},checkIfAvailable:function(e){return!(e.availableDentists>0)}}},J=F,W=(i("5383"),Object(c["a"])(J,M,I,!1,null,"1f80d5fc",null)),X=W.exports,Z=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("b-modal",{attrs:{title:"Confirmation Receipt","ok-only":"","ok-variant":"info"},on:{hidden:function(t){return e.modalClosed()}},model:{value:e.showModal,callback:function(t){e.showModal=t},expression:"showModal"}},[i("p",[e._v(e._s(e.bookingMessage))]),i("div",[i("p",[e._v("Clinic: "+e._s(e.selectedClinic.name))]),i("p",[e._v("Clinic Address: "+e._s(e.selectedClinic.address))]),i("p",[e._v("Appointment: "+e._s(e.displayInfo.time))]),i("p",[e._v("Reference: "+e._s(e.displayInfo.requestid))])])])],1)},K=[],ee=i("5530"),te=i("2f62"),ie={name:"ConfirmationModal",data:function(){return{bookingMessage:"Your booking has been made!",display:!1}},methods:{modalClosed:function(){this.$store.dispatch("booking/changeBookingStatus","viewed")},displayStatus:function(){this.display=!this.display}},computed:Object(ee["a"])(Object(ee["a"])({},Object(te["b"])({status:"booking/getBookingStatus",booking:"booking/getBooking"})),{},{showModal:{get:function(){return"received"===this.status},set:function(){}},displayInfo:function(){return this.booking.response},selectedClinic:{get:function(){return this.booking.request.dentistid?this.booking.request.clinic:""}}})},ne=ie,ae=Object(c["a"])(ne,Z,K,!1,null,"325ba76c",null),oe=ae.exports,se=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("b-modal",{attrs:{title:"Unsuccessful Booking","ok-only":"","ok-variant":"danger"},on:{hidden:function(t){return e.modalClosed()}},model:{value:e.showModal,callback:function(t){e.showModal=t},expression:"showModal"}},[i("p",[e._v("Your booking at "+e._s(e.selectedClinic.name)+" on the "+e._s(e.getRequestDate.date)+" at "+e._s(e.getRequestDate.time)+" was unsuccessful!")]),i("p",[e._v("Please try again!")])]),i("b-modal",{attrs:{title:"Unsuccessful Booking","ok-only":"","ok-variant":"danger"},on:{hidden:function(t){return e.modalClosed()}},model:{value:e.getErrorStatus,callback:function(t){e.getErrorStatus=t},expression:"getErrorStatus"}},[i("p",[e._v(e._s(e.getServerError))]),i("p",[e._v("Please try again!")])])],1)},re=[],ce=(i("b64b"),{name:"UnsuccessfulBookingModal",data:function(){return{display:!1}},methods:{modalClosed:function(){this.$store.dispatch("booking/changeBookingStatus","viewed")},displayStatus:function(){this.display=!this.display}},computed:Object(ee["a"])(Object(ee["a"])({},Object(te["b"])({status:"booking/getBookingStatus",booking:"booking/getBooking"})),{},{showModal:{get:function(){return"unsuccessfulBookingReceived"===this.status},set:function(){}},getErrorStatus:{get:function(){return Object.keys(this.booking.error).length>0},set:function(){}},getServerError:{get:function(){return this.booking.error?"Something went wrong...":""},set:function(){}},getRequestDate:function(){var e,t=this.booking.request.time,i={};(i.date="",i.time="",t)&&(t=null===(e=t)||void 0===e?void 0:e.split(" "),i.date=t[0],i.time=t[1]);return i},selectedClinic:{get:function(){return this.booking.request.dentistid?this.booking.request.clinic:""}}})}),le=ce,ue=Object(c["a"])(le,se,re,!1,null,"8bc41572",null),de=ue.exports,fe={name:"Home",components:{Map:T,MapSidebar:X,ConfirmationModal:oe,UnsuccessfulBookingModal:de},methods:{initSidebar:function(){this.$refs.MapSidebar.showSidebar()}}},pe=fe,be=(i("8263"),Object(c["a"])(pe,f,p,!1,null,"5fc98159",null)),ve=be.exports;n["default"].use(d["a"]);var me=new d["a"]({mode:"history",routes:[{path:"/",name:"home",component:ve}]}),he=me,ge=i("5f5b"),ye=(i("f9e3"),i("2dd8"),i("6f19")),ke=i("7bb1"),Ce={state:function(){return{dentists:[]}},namespaced:!0,actions:{addDentists:function(e,t){var i=e.commit;i("dentistsAdded",t)}},mutations:{dentistsAdded:function(e,t){e.dentists=t.dentists}}},_e=i("d4ec"),we=i("bee2"),Se=(i("25f0"),i("7040")),Oe=function(){function e(){Object(_e["a"])(this,e)}return Object(we["a"])(e,[{key:"connectToBroker",value:function(){Se["MQTT"].on("connect",(function(){console.log("Connected to Broker")}))}},{key:"subscribeToTopic",value:function(e){Se["MQTT"].subscribe(e,(function(){console.log("Subscribed to "+e)}))}},{key:"topicUnSubscriber",value:function(e){Se["MQTT"].unsubscribe(e,(function(){console.log("Unsubscribed from "+e)}))}}]),e}(),Ae=function(){function e(){Object(_e["a"])(this,e)}return Object(we["a"])(e,[{key:"getCurrentClinicID",value:function(){if(He.state.selectedClinic.clinic)return He.state.selectedClinic.clinic.id}},{key:"addAvailability",value:function(e){var t=e.toString("utf-8");He.dispatch("selectedClinic/addAvailability",JSON.parse(t))}},{key:"subscribeAvailability",value:function(){var e=new Oe;e.subscribeToTopic("availability/"+this.getCurrentClinicID())}},{key:"unSubscribeAvailability",value:function(e){var t=new Oe;t.topicUnSubscriber("availability/"+e)}},{key:"getCurrentDate",value:function(){if(He.state.availability)return He.state.availability.availabilityDate}},{key:"subscribeAvailabilityDate",value:function(e){var t=new Oe;t.subscribeToTopic("availabilityDate/"+e)}},{key:"addAvailabilityDate",value:function(e){var t=e.toString("utf-8");He.dispatch("availability/addAvailability",JSON.parse(t))}},{key:"unSubscribeAvailabilityDate",value:function(e){var t=new Oe;t.topicUnSubscriber("availabilityDate/"+e)}}]),e}(),Te={state:function(){return{clinic:{}}},namespaced:!0,getters:{getAvailability:function(e){return e.clinic.availability}},actions:{selectClinic:function(e,t){var i=e.commit;i("dentistSelected",t);var n=new Ae;n.subscribeAvailability()},addAvailability:function(e,t){var i=e.commit;i("availabilityAdded",t)},removeClinic:function(e,t){var i=e.commit,n=new Ae;n.unSubscribeAvailability(t),i("clinicRemoved")}},mutations:{dentistSelected:function(e,t){e.clinic=t},availabilityAdded:function(e,t){n["default"].set(e.clinic,"availability",t)},clinicRemoved:function(e){e.clinic={}}}},Me=i("1da1"),Ie=(i("96cf"),i("bc3a")),De=i.n(Ie),je=De.a.create({baseURL:"http://localhost:3000/"}),xe=function(){function e(){Object(_e["a"])(this,e)}return Object(we["a"])(e,[{key:"generateId",value:function(){var e=Object(Me["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,je.post("users/generate-id",t).then((function(e){return e.data}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()}]),e}(),Re=new xe,Be=i("f605"),Pe=i("7040"),$e=Pe.MQTT,Ee=function(){function e(){Object(_e["a"])(this,e)}return Object(we["a"])(e,[{key:"publishBookingRequest",value:function(e){$e.publish(Be["a"].REQUEST_TOPIC,JSON.stringify(e),{qos:1})}}]),e}(),qe=function(){function e(){Object(_e["a"])(this,e)}return Object(we["a"])(e,[{key:"checkResponse",value:function(e){var t=e.toString("utf-8"),i=JSON.parse(t),n=new Oe;n.topicUnSubscriber(Be["a"].RESPONSE_TOPIC+"/"+this.getUserId()),i.time?He.dispatch("booking/addBooking",i):He.dispatch("booking/addUnsuccessfulBooking",i)}},{key:"generateRequest",value:function(){var e=Object(Me["a"])(regeneratorRuntime.mark((function e(t,i,n,a){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Re.generateId(a).then((function(e){return{userid:e._id,requestid:e.requestsIdCounter,dentistid:t.id,issuance:Date.now(),time:i+" "+n.split(" ",1)}}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));function t(t,i,n,a){return e.apply(this,arguments)}return t}()},{key:"sendRequest",value:function(e){var t=new Ee,i=new Oe;t.publishBookingRequest(e),i.subscribeToTopic(Be["a"].RESPONSE_TOPIC+"/"+e.userid)}},{key:"getUserId",value:function(){return He.getters["booking/getBooking"].request.userid}}]),e}(),Ue={state:function(){return{booking:{response:{},request:{},status:{},error:{}}}},namespaced:!0,getters:{getBooking:function(e){return e.booking},getBookingStatus:function(e){return e.booking.status}},actions:{createBookingRequest:function(e,t){var i=e.commit,n=t.clinic,a=t.requestDate,o=t.requestTime,s=t.user,r=new qe,c=r.generateRequest(n,a,o,s);c.then((function(e){r.sendRequest(e);var t={};t=e,t.clinic=n,i("bookingRequestAdded",t)}),(function(e){i("bookingRequestNotGenerated",e)}))},addBooking:function(e,t){var i=e.commit;i("bookingAdded",t)},addUnsuccessfulBooking:function(e,t){var i=e.commit;i("UnsuccessfulBookingAdded",t)},changeBookingStatus:function(e,t){var i=e.commit;i("statusChanged",t)}},mutations:{bookingRequestAdded:function(e,t){e.booking.request=t,e.booking.status="sent"},bookingAdded:function(e,t){e.booking.response=t,e.booking.status="received"},UnsuccessfulBookingAdded:function(e,t){e.booking.response=t,e.booking.status="unsuccessfulBookingReceived"},statusChanged:function(e,t){e.booking.status=t,e.booking.error={}},bookingRequestNotGenerated:function(e,t){e.booking.error=t}}},Ne={state:function(){return{availabilityDate:{},availability:{}}},namespaced:!0,getters:{getAvailability:function(e){return e.availability}},actions:{selectDate:function(e,t){var i=e.commit;i("dateSelected",t);var n=new Ae;n.subscribeAvailabilityDate(t)},addAvailability:function(e,t){var i=e.commit;i("availabilityAdded",t)},removeAvailability:function(e,t){var i=e.commit,n=new Ae;n.unSubscribeAvailabilityDate(t),i("availabilityRemoved")}},mutations:{dateSelected:function(e,t){e.availabilityDate=t},availabilityAdded:function(e,t){e.availability=t},availabilityRemoved:function(e){e.availability={}}}};n["default"].use(te["a"]);var He=new te["a"].Store({modules:{dentist:Ce,selectedClinic:Te,booking:Ue,availability:Ne}}),Le=function(){function e(){Object(_e["a"])(this,e)}return Object(we["a"])(e,[{key:"processMessage",value:function(e){var t=e.toString("utf-8");He.dispatch("dentist/addDentists",JSON.parse(t))}}]),e}(),Ye=function(){function e(){Object(_e["a"])(this,e)}return Object(we["a"])(e,[{key:"listenForMessage",value:function(){var e=new Ae,t=new qe;Se["MQTT"].on("message",(function(i,n){if(i===Be["a"].DENTIST_TOPIC){var a=new Le;a.processMessage(n)}i===Be["a"].AVAILABILITY_TOPIC+"/"+e.getCurrentClinicID()&&e.addAvailability(n),i===Be["a"].RESPONSE_TOPIC+"/"+t.getUserId()&&t.checkResponse(n),i===Be["a"].AVAILABILITY_PERCENTAGE_TOPIC+"/"+e.getCurrentDate()&&e.addAvailabilityDate(n)}))}}]),e}(),Ge=function(){function e(){Object(_e["a"])(this,e)}return Object(we["a"])(e,[{key:"establishConnection",value:function(){var e=new Oe,t=new Ye;e.connectToBroker(),e.subscribeToTopic(Be["a"].DENTIST_TOPIC),t.listenForMessage()}}]),e}();n["default"].use(ge["a"]),n["default"].use(te["a"]);var Ve=new Ge;Ve.establishConnection(),n["default"].config.productionTip=!1,n["default"].component("ValidationProvider",ye["a"]),n["default"].component("ValidationObserver",ke["a"]),new n["default"]({router:he,store:He,render:function(e){return e(u)}}).$mount("#app")},"5ca7":function(e,t,i){},6:function(e,t){},7040:function(e,t,i){"use strict";i.r(t),i.d(t,"MQTT",(function(){return o}));var n=i("f605"),a=i("e7fc"),o=a.connect(n["a"].URL)},8263:function(e,t,i){"use strict";i("c115")},"85ec":function(e,t,i){},"9e74":function(e,t,i){"use strict";i("5250")},c115:function(e,t,i){},f605:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var n={URL:"ws://127.0.0.1:1884",DENTIST_TOPIC:"dentists",AVAILABILITY_TOPIC:"availability",REQUEST_TOPIC:"request",RESPONSE_TOPIC:"response",AVAILABILITY_PERCENTAGE_TOPIC:"availabilityDate"}}});
//# sourceMappingURL=app.e1456c85.js.map